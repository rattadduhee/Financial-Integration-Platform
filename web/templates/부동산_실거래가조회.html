<!DOCTYPE html>
{% load static %}
<html style="font-size: 16px;" lang="en"><head>
    
    <meta charset="utf-8">
    <meta name="keywords" content="Business Center">
    <meta name="description" content="">
    <title>실거래가 조회</title>
    <style>
      table { 
        font-size: .9em;
        box-shadow: 0 2px 5px rgba(0,0,0,.25);
        width: 100%;
        text-align: center;
        display:inline-table;
      }
  
      thead {
        font-weight: bold;
        font-size:22px;
        color: #fff;
        background: #8F7E6D;
      }
        
      th {
        padding:.5em; 
      }
        
      td {
        padding:.5em; 
        font-size:20px;
        border-bottom: 1px solid rgba(0,0,0,.1);
        background: #fff;
      }
    </style>
    <script>
        function add(num) {
            var regexp = /\B(?=(\d{3})+(?!\d))/g;
            return num.toString().replace(regexp, ','); 
          }
    </script>
<link rel="stylesheet" href="{% static '/CSS/default.css' %}" media="screen">
<link rel="stylesheet" href="{% static '/CSS/부동산_실거래가-조회.css' %}" media="screen">
<script class="u-script" type="text/javascript" src="{% static '/javascript/jquery.js'%}" defer=""></script>
    <script class="u-script" type="text/javascript" src="{% static '/javascript/nicepage.js'%}" defer=""></script>
    <meta name="generator" content="Nicepage 4.18.5, nicepage.com">
    
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oswald:200,300,400,500,600,700|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": ""
}</script>
    <meta name="theme-color" content="#59bec1">
    <meta property="og:title" content="부동산_실거래가 조회">
    <meta property="og:type" content="website">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  </head>
  <body class="u-body u-xl-mode" data-lang="en"><header class="u-clearfix u-header u-white u-header" id="sec-8229"><div class="u-align-left u-clearfix u-sheet u-sheet-1">
        <img class="u-image u-image-contain u-image-default u-image-1" src="{% static '/images/KB1.png'%}" alt="" data-image-width="602" data-image-height="468">
        <h1 class="u-custom-font u-text u-text-default u-text-1">
          <a class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-black u-btn-1" href="{% url 'home' %}">KB 재테크 플랫폼</a>
        </h1>
        <nav class="u-align-right u-menu u-menu-one-level u-offcanvas u-menu-1" data-responsive-from="MD">
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-spacing-20 u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url 'home' %}" style="padding: 10px;">Home</a>
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url '부동산' %}" style="padding: 10px;">부동산</a>
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url '주식' %}" style="padding: 10px;">주식</a>
                {% if user.is_authenticated %}
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url '적금카드' %}" style="padding: 10px;">적금/카드</a>
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url '소비' %}" style="padding: 10px;">나의소비성향</a>
            {%else%}
            {%endif%}
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url '설명회' %}" style="padding: 10px;">설명회정보</a>
                 {% if user.is_authenticated %}
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1"  href="{% url 'logout' %}" style="padding: 10px;">로그아웃</a>
            {% else %}
            </li><li class="u-nav-item"><a class="u-border-active-palette-1-base u-border-hover-palette-1-base u-button-style u-nav-link u-text-active-custom-color-1 u-text-grey-90 u-text-hover-custom-color-1" href="{% url 'login' %}" style="padding: 10px;">로그인</a>
            {% endif %}
            </li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url 'home' %}">Home</a>
                </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url '부동산' %}">부동산</a>
                </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url '주식' %}">주식</a>
                </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url '적금카드' %}">적금/카드</a>
                </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url '설명회' %}">설명회정보</a>
                </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url '소비' %}">나의소비성향</a>
                </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="{% url 'login' %}">로그인</a>
                </li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-668c">
      <div class="u-clearfix u-sheet u-sheet-1" >
        <h3 class="u-custom-font u-text u-text-default u-text-1"> 부동산 재테크</h3>
        <div class="map_wrap" >
          <div id="map" style="width:500px;height:400px;"></div> 
          <div id="menu_wrap" class="bg_white"> </div>
          <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=942c1099b5a044b78b48641ed686369c&libraries=services"></script>
                <div id = 'search' class="u-form u-form-1" style="position: absolute; top:100px">
                    <div>
                        <form method="POST">
                          <div class="u-form-group u-form-name"></div>
                            <label for="name-05a6" class="u-label" style="font-size:20px">아파트명 검색</label>
                            <input type="text" placeholder="예) 신반포자이" id="keyword" value="{{apt}}" name="keyword" class="u-border-1 u-border-grey-30 u-input u-input-rectangle u-white" required="" style="width:490px;font-size:20px;">
                            <button type="submit" class="u-btn u-btn-round u-btn-submit u-button-style u-radius-16" style="margin-left:180px;font-size:20px;">SEARCH</button> 
                        </form>
                    </div>
                </div>                
               
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script >    
            // 마커를 클릭하면 장소명을 표출할 인포윈도우 입니다
            var infowindow = new kakao.maps.InfoWindow({zIndex:1});

            var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
                mapOption = {
                    center: new kakao.maps.LatLng(37.566826, 126.9786567), // 지도의 중심좌표
                    level: 3 // 지도의 확대 레벨
                };  

            // 지도를 생성합니다    
            var map = new kakao.maps.Map(mapContainer, mapOption); 

            // 장소 검색 객체를 생성합니다
            var ps = new kakao.maps.services.Places(); 

            // 키워드로 장소를 검색합니다
            ps.keywordSearch('{{apt}}', placesSearchCB); 

            // 키워드 검색 완료 시 호출되는 콜백함수 입니다
            function placesSearchCB (data, status, pagination) {
                if (status === kakao.maps.services.Status.OK) {
                    // 검색된 장소 위치를 기준으로 지도 범위를 재설정하기위해
                    // LatLngBounds 객체에 좌표를 추가합니다
                    var bounds = new kakao.maps.LatLngBounds();
                    
                    displayMarker(data[0]);    
                    bounds.extend(new kakao.maps.LatLng(data[0].y, data[0].x));

                    // 검색된 장소 위치를 기준으로 지도 범위를 재설정합니다
                    map.setBounds(bounds);
                } 
            }

            // 지도에 마커를 표시하는 함수입니다
            function displayMarker(place) {
                
                // 마커를 생성하고 지도에 표시합니다
                var marker = new kakao.maps.Marker({
                    map: map,
                    position: new kakao.maps.LatLng(place.y, place.x) 
                });

                // 마커에 클릭이벤트를 등록합니다
                kakao.maps.event.addListener(marker, 'click', function() {
                    // 마커를 클릭하면 장소명이 인포윈도우에 표출됩니다
                    infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
                    infowindow.open(map, marker);
                });
            }
        </script>
          <br><br>
          {% if apt_list %}
            <div style="margin-left:100px; height:600px">
              <div style='top:40px;'>
              <section style="left:-50px;">                              
                <div class="container">            
                  <table style="width:1000px;margin-left: 40px;">
                    <thead>  
                      <tr>
                        <th>단지명</th>
                        <th>거래금액</th>
                        <th>층</th>
                        <th>건축년도</th>
                        <th>지역</th>                        
                        <th>평</th>
                        <th>계약년도</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for i in apt_list %}
                      <tr>
                        <td>{{i.apt_name}}</td>
                        <script>
                          document.write("<td>" + add("{{i.price}}") +"만원</td>")
                        </script>
                        <td>{{i.floor}}층</td>
                        <td>{{i.arc_year}}년</td>
                        <td>서울시 {{i.gu}} {{i.dong}}</td>
                        <td>{{i.pyeong}}평</td>
                        <td>{{i.cont_year}}년</td>
                      </tr>
                    {% endfor %}
                    </tbody>
                  </table>
                  {% if msg %}
                  <p style="font-size: 17px; text-align: right;">{{msg}}</p>
                  {%endif%}
                </div>
                </div>
              </div>
              <br><br>
              <script src="https://d3js.org/d3.v6.min.js"></script>
              <link rel="stylesheet" href="{% static '/CSS/billboard.css' %}">
              <script src="{% static '/javascript/billboard.js'%}"></script>
              <link rel="stylesheet" href="{% static '/CSS/insight.css' %}">
               
              <div id="chart" style="width:1100px;height:600px;font-size: 20px;"></div>
              <script>
                const apt_price = {{price|safe}} // 단지명&평수별 가격
                const lab = []
                const year = {{years|safe}} // 단지명&평수별 거래년도(예) 28평 [2014,2016,2022] 3건)
                const apt_prices = []
                const xs = {}
                const types = {}
                year.len = Array.from({length: Object.keys(year).length}, (item, index) => index)
                for (const i in year.len) {
                  xs[Object.keys(year)[i]] = `${Object.keys(year)[i]}`+'계약년'
                  const land = year[Object.keys(year)[i]].map(String)
                  land.unshift(`${Object.keys(year)[i]}`+'계약년')
                  lab.push(land)
                  var value = apt_price[Object.keys(apt_price)[i]]
                  value.unshift(`${Object.keys(apt_price)[i]}`)
                  apt_prices.push(value)
                  types[Object.keys(year)[i]] = "spline"
                }
                for (const i in year.len){
                  lab.push(apt_prices[i])
                }
                var chart = bb.generate({
                  data: {
                    xs: xs,
                    columns: lab,
                    types: types
                  },
                  bindto: "#chart",
                  
                });
              </script>
              
              {% endif %}</div><br><br>
                <a href="{% url '부동산' %}" class="u-btn u-btn-round u-button-style u-radius-17 u-btn-2" >뒤로가기</a>
                <br>
           </div></section>
  
            <footer class="u-clearfix u-footer u-grey-25" id="sec-abf8"><div class="u-clearfix u-sheet u-sheet-1">
              <div class="u-clearfix u-expanded-width u-gutter-30 u-layout-wrap u-layout-wrap-1">
                <div class="u-gutter-0 u-layout">
                  <div class="u-layout-row">
                    <div class="u-align-left u-container-style u-layout-cell u-left-cell u-size-60 u-layout-cell-1">
                      <div class="u-container-layout u-container-layout-1">
                        <h6 class="u-text u-text-1">KB IT'S Your Life</h6>
                        <p class="u-text u-text-2">WonJi-Jeong, JooHee-Shin, Hyein-We, SeongJun-Lim, YoungBon-Ji</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div></footer>
         
        
      </body></html>